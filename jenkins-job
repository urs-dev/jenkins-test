#!/usr/bin/env groovy
echo 'Job build by: ${env.USERNAME}'
echo '------------------------------------------------'
echo ">>> ${env.BUILD_ID} :: ${env.JOB_NAME} :: ${env.JENKINS_URL}"


// echo "$WORKSPACE"
// echo "WORKSPACE =  ${WORKSPACE}"
echo "WORKSPACE =  ${env.WORKSPACE}"

echo '------------------------------------------------'

pipeline {
    agent any

    stages {
        stage('xxxx') {
            steps {
                echo 'Building..'
                echo "WORKSPACE =  ${env.WORKSPACE}"
                // copy Job-1
                def src = new File('${env.WORKSPACE}/job-1.ps1')
                def dst = new File('D:/6_DEV/Jenkins-Test/run_job-1/job-1.ps1')
                dst << src.bytes
            }
        }
        stage('deploy') {
            steps {
                echo 'deploy to run environent ...'
            }
        }
        stage('run tasks') {
            steps {
                echo 'run tasks ...'
            }
        }
    }
}

echo "------------------------------------------------------------------"
echo "Job finished: ${env.BUILD_ID} on ${env.JENKINS_URL}"
